version: '3.9'

services:
  web:
    container_name: phre_api
    build:
      context: '.'
      target: dev
      args:
        DDE_UID: ${DDE_UID}
        DDE_GID: ${DDE_GID}
    environment:
      - VIRTUAL_HOST=phre-api.test
      - SSH_AUTH_SOCK=/tmp/ssh-agent/socket
    volumes:
      - ssh-agent_socket-dir:/tmp/ssh-agent:ro
      - ./:/var/www
    hostname: phre-api
    domainname: phre-api.test

networks:
  default:
    name: "dde"
    external: true

volumes:
  ssh-agent_socket-dir:
    name: dde_ssh-agent_socket-dir
    external: true
